---
lang: "en"
toc-title: "Contents"
title: "Orange Dot Report 5.0"
subtitle: "Family Self-Sufficiency in the Charlottesville Region"
date: 'October 27, 2022'
author: 'Ridge Schuyler, Michele Claibourn, Lee LeBoeuf, Elizabeth Mitchell^[**Ridge Schuyler**, Dean, Division of Community Self-Sufficiency Programs - Network2Work\@PVCC, Piedmont Virginia Community College, originated the Orange Dot Report in 2011 and has authored three prior updates (2015, 2018, 2021). This year begins a partnership with The Equity Center at the University of Virginia to support the ongoing updates, authorship, and expansion of this work. **Michele Claibourn**, Director of Equitable Analysis, The Equity Center, University of Virginia and Assistant Professor, Batten School of Leadership and Public Policy, University of Virginia. **Lee LeBoeuf**, Research Data Fellow, The Equity Center, University of Virginia and Ph.D. Candidate, Department of Psychology, University of Virginia. **Elizabeth Mitchell**, Research Programs Manager, The Equity Center, University of Virginia.
]'
output: 
  html_document:
      template: orange-dot-template.html
      css: styles.css
      toc: true
      toc_depth: 1
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r libs}
library(tidyverse)
library(sf)
library(leaflet)
# devtools::install_github("johannesbjork/LaCroixColoR")
# library(LaCroixColoR)
library(flextable)
library(officer)
library(scales)
library(patchwork)

# ACS data
tractdat <- read_csv("data/acs_tract_orangedot.csv")
tractdat$GEOID <- as.character(tractdat$GEOID)
countydat <- read_csv("data/acs_county_orangedot.csv")

# tract names 
tnames <- read_csv("data/tractnames.csv")
tnames$GEOID <- as.character(tnames$GEOID)

tractdat <- tractdat %>%
  left_join(tnames[,c('tractnames', 'GEOID')], by = "GEOID")

# sort by locality (alphabetically, for table order)
countydat <- countydat %>% arrange(countyName)

# Spatial data
geo <- readRDS("data/cvilleODreport_tracts.RDS")
geo$GEOID <- as.character(geo$GEOID)

geofull <- geo %>%
  left_join(tractdat, by = "GEOID")

geofull <- st_transform(geofull, crs = 4326) 

expenses <- read_csv("data/Expenses-SH-2kids.csv")

highlightcolor <- "#EE6100"
lowlightcolor <- "#FFAD0A"

set_flextable_defaults(
  background.color = "#FFFFFF"
)
```

# Preface

The first Orange Dot Report was released in 2011, and it served both to describe the local income deficit—the gap between what families receive as income and what they need to earn to be self-sufficient—in Charlottesville and to develop strategies for creating pathways to self-sufficiency for families in the region. This initial effort launched the innovative Network2Work framework pioneered at Piedmont Virginia Community College, a process that brings together a Job-Seeker Network, an Employer Network, and a Provider Network to match job-seekers to family-sustaining jobs and careers and to connect them to community resources using neighborhood-based volunteers.

As Network2Work has grown, the Orange Dot Report has also expanded, encompassing Charlottesville and Albemarle County in Orange Dot Report 2.0 (2015) and the entire region (Albemarle, Buckingham, Charlottesville, Fluvanna, Greene, Louisa, and Nelson) in Orange Dot Report 3.0 (2018) and Orange Dot Report 4.0 (2021). Along the way, the report has come to serve as a central resource for the community and an important update on the progress of our community.

This effort, Orange Dot Report 5.0, represents the continuation of our progress toward a more fully and equitable thriving region. Incorporating an updated description of the condition of families in our larger region, Orange Dot 5.0 marks the beginning of an annual update completed in partnership between Network2Work\@PVCC and The Equity Center at the University of Virginia. We will be providing an update of the report in early spring incorporating the most recent information from the U.S. Census’ American Community Survey along with more assessment of community efforts and progress in creating realistic pathways to self-sufficiency.


# Summary

In the larger Charlottesville community, 9,413 families (14%) do not make enough money to afford the essentials of life—food, shelter, clothing and utilities—and the added costs associated with working—childcare and transportation. This number represents the families making less than $35,000 in our region. 

This is a significant improvement since the first Orange Dot Report in 2011. For the Charlottesville region, defined here as the city of Charlottesville and the surrounding counties of Albemarle, Buckingham, Fluvanna, Greene, Louisa and Nelson, the comparable number of families struggling in the region in 2011 was 12,552, which was 21% of families. Over one out of five families. **The 2022 number–9,413 families–is a 25% reduction in the number of struggling families in the region.** 

We recognize, however, that the cost of essentials has gone up over time. For example, these basic needs currently require over $45,000 a year for a single parent with a toddler in childcare.^[Assuming all families in the region match this “model” family type, 20% of the families would fall below this higher threshold] In this report, we continue to use the $35,000 income threshold as the break point for defining struggling families to remain consistent with the four prior reports, so these numbers should be understood as a minimum–at least 9,413 families are struggling.

While families facing economic insecurity live throughout our region, the likelihood that a family is struggling varies by race and by place. The struggle is not equally shared. 

* Thirty-two percent of Black families make less than $35,000 a year, compared to 11% of white families, a persistent gap resulting from past and ongoing policies that suppress investment, opportunity, and wealth creation in Black communities. 
* The percent of families struggling overall is highest in Buckingham County, at 28%, and lowest in Louisa County, at 8%. 
* Within every locality except Fluvanna, there are neighborhoods where a quarter or more of families have less than family-sufficient incomes. The four neighborhoods with the highest percent of struggling families are in the city of Charlottesville.

Our community has seen progress since this work began in 2011, but there are still too many struggling families. For a region as prosperous as ours, however, ten thousand families is not too many to help.


# Introduction

> "[W]henever you are engaged in work that serves humanity and is for the building of humanity, it has dignity, and it has worth [...] All labor has dignity." 
>
> --- Martin Luther King Jr.^[Martin Luther King, Jr. (March 18, 1968). Retrieved from https://www.beaconbroadside.com/broadside/2018/03/the-50th-anniversary-of-martin-luther-king-jrs-all-labor-has-dignity.html]

The last few years have brought our country’s and our community’s ongoing struggles and inequities into stark relief. The continued pandemic, the growing housing affordability crisis, the increasing volatility of man-made climate change have created challenges for all of us. But low-income individuals, especially individuals of color, are suffering disproportionately, both physically and financially. 

Despite working hard, too many families struggle to make ends meet, in part because their work is not treated with dignity. Or at least, their labor is not valued as though their work has dignity. While the enormous value, the essentialness, of the labor performed by “front-line” workers became clear to all during the pandemic, many people laboring in these positions do not earn enough to provide for their families. For example, the so-called “caring economy”—childcare workers, home health aides, teachers—provides enormous social value, but is not given market value. Rising prices and inflation will only worsen the strain.

We all seek security and stability: to feed our families, to see our children thrive, to create community with others, to promote our wellbeing. For families experiencing economic insecurity, all of this is jeopardized. When faced daily with financial struggles—to pay for housing, to repair the car that carries you to work, to put food on the table, to find and afford a safe environment for your children—it is difficult to be the parent you want to be, the worker you know you could be, or the person you were meant to be. We all deserve a chance to thrive, but we are all not yet given that chance. Towards that end, we must seek to build an equitable economy, one intentionally constructed on a foundation of racial justice.

Knowing that we can only solve issues we can understand, we provide a snapshot of the families in our community who are struggling, an update to the Orange Dot Project report first issued in September 2011.^[To find previous versions of the Orange Dot report, go to https://www.pvcc.edu/history-network2workpvcc-program] 

What we have learned since this work began in 2011 is that there are too many struggling families in our community, but not too many to help.


# Struggling Families

There are 66,633 families living in the Charlottesville region, defined as the city of Charlottesville and the surrounding counties of Albemarle, Louisa, Nelson, Buckingham, Greene, and Fluvanna.^[Family is defined as two or more people related by birth, marriage, or adoption and living in the same household. U.S. Census Bureau (2020). Household Type, 2016-2020. Retrieved from https://data.census.gov/cedsci/table?q=B11001&g=0500000US51003,51029,51065,51079,51109,51125,51540&tid=ACSDT5Y2020.B11001.]

Of these, 9,413 families (14%) do not make enough money to afford the essentials of life—food, shelter, clothing and utilities—and the added costs associated with working (childcare and transportation).^[This report reflects the U.S. Census Bureau's American Community Survey 5-year averages, 2016-2020.]

While this is still too many families, this is a decrease compared to the numbers provided in the prior report just two years ago. In the Orange Dot Report 4.0, there were 10,940 families (17%) who did not earn enough to meet their basic needs. Since then our community has seen that number reduced by nearly fourteen percent.^[This is a community success, brought about primarily by the hard work of the job-seekers themselves, made possible by the quality employers who hired them, and propelled by the social and material support supplied by family, friends and a network of community-based organizations and agencies.]

## Number of Families Struggling in the Region {.figure-title}

```{r}
# flextable
strfam_tot <- countydat %>%
  dplyr::select(countyName, AllFamUnder35kE, perc_AllFamUnder35kE) %>%
  rename(Locality = countyName,
         Number = AllFamUnder35kE,
         Percent = perc_AllFamUnder35kE) %>% 
  mutate(Percent = round(Percent,1))

flextable(strfam_tot) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Number > 9000, bg = lowlightcolor) %>%
  color(i = ~Number > 9000, color = "black") %>% 
  colformat_num(j = "Percent", suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  set_header_labels(values = list(Number = "Number of Families Struggling", Percent = "Percent of Families Struggling"))

```
<br/>

Families in our community generally need to earn at least $35,000 annually to meet their basic needs, as detailed in the locality profiles provided in this report. While some of the 9,413 families struggling in our community appear to have limited earning capacity (those with incomes under $14,999), most are working and earning income ($15,000-$34,999), just not enough to support their families.

## Breakdown of Families Making under $35,000 {.figure-title}

```{r}
income_break <- countydat %>% 
  filter(countyName != "Whole Region") %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break[5,2])

income_break <- income_break %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1))%>%
  color(j = "Cumulative", i = ~ Cumulative > 70, color = "white") 
```
<br/>

This highlights an important distinction. There are at least two categories of struggling families—those who are closer to self-sufficiency and who can more readily earn more with the right opportunities, and those whose earning potential is more limited—and different strategies are required to improve the lives of families within each.

For most families, low-incomeness is not a constant, not an immutable condition that must be worked around, but a variable that must be changed. For a family experiencing economic struggle, the first question should be: What do they need to increase their income?

Some families are on fixed incomes or have otherwise reached a more constrained earning potential due to illness, caregiving responsibilities, and other circumstances. These families are unlikely to see their incomes increase appreciably and require sustained subsidy to meet their basic needs of food, shelter, clothing and utilities. Based on the income data above, which shows 3,057 families make less than $15,000 annually (28%), as well as data from Charlottesville’s housing affordability study,^[Partners for Economic Solutions (2018). Housing Needs Assessment: Socioeconomic and Housing Market Analysis. Washington, D.C.: Form-Based Code Institute/Smart Growth America, 58.] for roughly one-third of the families who are struggling, a self-sufficient family income will be out of reach. Their survival depends on the strength of the social safety net.

The vast majority of families, however, have the capacity to earn a family-sufficient income. They are working, but their labor is not sufficiently valued.

The undervaluing of labor has far-reaching consequences. The myth of American meritocracy promotes the idea that those who work hard and play by the rules will get ahead. The flipside of that myth—if you haven’t gotten ahead, it must be because you don’t work hard enough or play by the rules—leads to negative beliefs about the poor in our society and, subsequently, to reduced support for resources and programs meant to reduce the burdens of poverty. Working hard, however, does not guarantee that individuals will get ahead. Take the formula below:

<div class="shadowbox">
Hard Work  x  High Wages  =  High Income
<br/>
Hard Work  x  Low Wages  =  Low Income
</div>

The difference between these outcomes is not the hard work individuals put in, but the wages paid out. A full-time worker making Virginia’s minimum wage will have a gross income of $22,000 per year.^[Based on wage of $11/hour.] To reduce the number of struggling families, therefore, requires an increase in their wages. We need a system that identifies the 72% of low-income families who are working for a living but who are not valued, and help them increase their value in the eyes of their employers.

<br/>
```{r, fig.alt= "Two pie charts showing percents of families in the Charlottesville Region paid a living wage. The first shows 86% of families are paid a living wage and 14% are not paid a living wage. The second shows that of that 14% not paid a living wage, 73% are paid close to a living wage and 27% are not paid close to a living wage.", fig.align = "center", out.width = "100%"}
knitr::include_graphics("images/PictureChart.png")
```
<br/>

To get ahead, those workers will need jobs and careers that pay enough to support their families.

We all benefit when the families in our community have access to jobs that pay sufficient incomes. Among the many advantages include:

**Children do better.** Graduating from college continues to be the fastest route to economic security, yet economic insecurity limits access to higher education. As Robert Putnam’s work shows, “a family’s socioeconomic status [has] become even more important than test scores in predicting which eighth graders would graduate from college. High-scoring poor kids are now slightly less likely (29%) to get a college degree than low-scoring rich kids (30%).”^[Putnam, R. (2015). Our Kids: The American Dream in Crisis. New York, NY: Simon & Schuster, 189-190.]

**Local businesses benefit.** Employees are also consumers, and increased income among a region’s workers means more spending power, which is better for the economy, especially the local economy.

**Taxpayers benefit.** Given the chance, families want to provide for themselves. When they are able to do so, they require less support from others.

**People live longer.** According to the Centers for Disease Control, the biggest contributor to poor health is low socio-economic status. The Health Inequality Project estimates that a woman in the Charlottesville area in the lowest income quartile has a life expectancy of seven years less than a woman from the highest income quartile; among men in our region, the life expectancy gap is nearly ten years.^[Chetty R., Stepner M., Abraham S., Lin S., Scuderi B., Turner N., Bergeron A., and Cutler D., (2016). The Association Between Income and Life Expectancy in the United States, 2001-2014. JAMA 315:1750–1766. doi:10.1001/jama.2016.4226. Data: https://healthinequality.org/data/]

**The community thrives.** A community thrives when its residents thrive. Residents thrive when their capacity as human beings is unleashed. And their capacity as human beings can only be unleashed when their basic needs are met. 


# The Intersection with Race

Too many families are struggling in our region, but these burdens are not equally shared. Throughout our country and our history, the labor of our Black neighbors has been systematically valued less than the labor of our White neighbors. The undervaluing of Black labor has been reinforced through many policies from those we’ve collectively recognized as racially discriminatory—enslavement, Black codes, Jim Crow, Massive Resistance—to ongoing and often unacknowledged choices—a legacy of disinvestment in and displacement of Black communities, the blocking of wealth creation through red-lining and predatory lending, disproportionate contact with law enforcement and overincarceration, disenfranchisement and political demobilization, overt and subconscious negative stereotypes. And the list could go on.

These policies and choices have generated a significant racial wealth gap. The Federal Reserve Bank of St. Louis calculated that the average net worth of a white family in America was ten times greater than the net worth of a Black family, as shown below.^[Mock, B. (2019, March 21). Why Can’t We Close the Racial Wealth Gap? Bloomberg City Lab. Retrieved from https://www.bloomberg.com/news/articles/2019-03-21/how-income-inequality-feeds-the-racial-wealth-gap. Data on unequal labor income in our region comes from U.S. Census Bureau (2020). Family Income in the Past 12 Months. American Community Survey 5-Year Estimates, 2014-2018, Tables B19101, 19101A, 19101B.]

<br/>
```{r, fig.alt="Distribution of family wealth by race and ethinicity. Wealth gaps in terms of Black and Hispanic families' cents per every dollar of white family wealth shown for percentile groups. Source: Federal Reserve Bank of St. Louis.", fig.align = "center", out.width = "80%"}
knitr::include_graphics("images/WealthGap.png")
```
<br/>

That racial wealth gap is best explained by unequal labor income, according to research from the Federal Reserve Bank of Cleveland.^[Mock, B. (2019, March 21). Why Can't We Close the Racial Wealth Gap? Bloomberg City Lab. Retrieved from https://www.bloomberg.com/news/articles/2019-03-21/how-income-inequality-feeds-the-racial-wealth-gap.]

<br/>
```{r, fig.alt="Figure showing percent of racial wealth gap from 1962 to 2007. Title: A racial income gap explains the US's wealth gap today. Subtitle: Federal Reserve Bank economists found unequal incomes explain the black-white wealth gap's persistence today more than inherited wealth or investment returns. Source: Federal Reserve Bank of Cleveland research economists Dionissi Aliprantic and Daniel Carroll.", fig.align = "center", out.width = "80%"}
knitr::include_graphics("images/IncomeGap.jpg")
```
<br/>

This struggle is not new. When Dr. Martin Luther King, Jr. stood on the steps of the Lincoln Memorial on August 28, 1963 to deliver his iconic I Have A Dream speech, he was addressing a “March for Jobs and Freedom.” When he was assassinated at the Lorraine Motel on April 4, 1968, he was in Memphis to stand shoulder to shoulder with Black sanitation workers fighting for higher wages.

This struggle is also local, as was made stark in the violence and terror of August 11 and 12, 2017. And the unequal labor income within the nation is reflected in our community as well. As shown below, the percent of Black families making less than family-sustaining income is consistently higher across our region than the percent of white families struggling, and is especially high in Albemarle and Charlottesville.^[Data on unequal labor income in our region comes from U.S. Census Bureau (2020). Family Income in the Past 12 Months. American Community Survey 5-Year Estimates, 2014-2018, Tables B19101, 19101A, 19101B.]

## Families Making under $35,000 by Race {.figure-title}

```{r, fig.width = 10, fig.height = 8}
cnty_race_long <- countydat %>% 
  filter(countyName != "Whole Region") %>% 
  select(countyName, count_AllFamUnder35kE = AllFamUnder35kE, 
         count_BlackFamUnder35kE = BlackFamUnder35kE, count_WhiteFamUnder35kE = WhiteFamUnder35kE,
         perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE) %>% 
  pivot_longer(-countyName, names_to = c(".value", "fam"), names_sep = "_") %>% 
  mutate(fam = factor(fam, levels = c("AllFamUnder35kE", "BlackFamUnder35kE", "WhiteFamUnder35kE"),
                        labels = c("All families", "Black families", "White families")))

numplot <- ggplot(cnty_race_long, aes(y = count, 
                           x = fct_reorder(countyName, count), 
                           fill = fct_rev(fam))) + 
  geom_bar(position="dodge", stat="identity") +
  geom_text(aes(label = comma(count)),
            position = position_dodge(width=0.9), hjust = -0.2, 
            size = 4) + 
  labs(title = "Number of Families", x = "", y = "") + 
  scale_fill_manual(values=c("#7473A6", "#1BB6AF", "#FFAD0A"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_comma(),
                     limits = c(0,3200)) +
  annotate("text", x = "Greene", y = 2200, color = "black",
           label = "9,413 families\n in region", size = 5) +
  theme_minimal() +
  coord_flip() +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        axis.text=element_text(size=10),
        legend.text = element_text(size=14),
        plot.title = element_text(size=16, hjust = 0.5))

allperc <- as_vector(countydat %>% filter(countyName == "Whole Region") %>% 
                       select(perc_AllFamUnder35kE))

percplot <- ggplot(cnty_race_long, aes(y = perc,
                           x = fct_reorder(countyName, count), 
                           fill = fct_rev(fam))) + 
  geom_bar(position="dodge", stat="identity") +
  geom_text(aes(label = percent(perc, scale = 1, accuracy = 0.1)),
            position = position_dodge(width=0.9), hjust = -0.25, 
            size = 4) + 
  labs(title = "Percent of Families", x = "", y = "") + 
  scale_fill_manual(values=c("#7473A6", "#1BB6AF", "#FFAD0A"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1),
                     limits = c(0,55)) +
  geom_hline(yintercept = allperc, color = "gray50", linetype = "dashed") +
  annotate("curve", y = 30, x = 1, yend = 14.5, xend = 1.7, 
           curvature = -0.1, arrow = arrow(length = unit(2, "mm")),  color = "gray50") +
  annotate("text", x = 1, y = 30.5, size = 5, color = "black",
           label = "14% of families\n in region", hjust = "left") +
  theme_minimal() +
  coord_flip() +
  guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        axis.text=element_text(size=10),
        legend.text = element_text(size=14),
        plot.title = element_text(size=16, hjust = 0.5))

numplot + percplot + 
  plot_layout(guides = 'collect') &
  theme(legend.position='bottom')
```
<br/>

We need to be intentional about helping all families in our community who are struggling to achieve self-sufficient income, but must be especially attentive to Black families who are struggling in our economy as they may understandably be distrustful or disconnected from the very institutions positioned to help.


# Locality Profiles

The following sections explore each locality separately, detailing what it costs to be self-sufficient in each of the localities that comprise the region—including the costs of food^[U.S. Department of Agriculture, Center for Nutrition Policy and Promotion (2022). Official USDA Food Plans: Cost of Food at Home at Four Levels, U.S. Average, May 2022, Weekly Cost of the Low-Cost Plan. Retrieved from https://www.fns.usda.gov/sites/default/files/media/file/CostofFoodMay2022Thrifty.pdf], shelter^[Virginia Housing (2022). 2022 Fair Market Rents. Retrieved from https://www.huduser.gov/portal/datasets/fmr/fmrs/FY2022_code/2022summary.odn], clothing^[U.S. Department of Agriculture, Center for Nutrition Policy and Promotion (2017). Expenditures on Children by Families, Estimated annual expenditures on a child by single-parent families. Retrieved from https://www.fns.usda.gov/sites/default/files/resource-files/crc2015-march2017.pdf and U.S. Bureau of Labor Statistics (2020). Consumer Expenditures Survey, CE Tables, Age of Reference Person, Apparel and Services by Women, 16 and over. Retrieved from https://www.bls.gov/cex/tables/calendar-year/mean-item-share-average-standard-error/reference-person-age-ranges-2020.pdf], utilities^[Virginia Housing Development Authority (2022). Allowances for Tenant-Furnished Utilities and Other Services, Two Exposed UA Schedule. Retrieved from https://mc-0e9acafd-48f4-4c49-b478-6257-cdn-endpoint.azureedge.net/-/media/docs/partners/housing-choice-vouchers/utility-allowance/2exposed-walls.pdf?rev=91c81573c2e94b8cb314f871bbad5e65&hash=666946C107D54311AC4222AC1E81F850 and the U.S. Bureau of Labor Statistics (2020), Consumer Expenditure Survey, Telephone Services. Retrieved from https://www.bls.gov/cex/tables/calendar-year/mean-item-share-average-standard-error/reference-person-age-ranges-2020.pdf], childcare^[Virginia Department of Social Services, Division of Child Care and Early Childhood Development (2021). Child Care Subsidy Program Guidance Manual. Richmond, Virginia. Retrieved from https://doe.virginia.gov/cc/files/child-care-subsidy-guidance-manual.pdf.], transportation^[U.S. Bureau of Labor Statistics (2020). Consumer Expenditures Survey, CE Tables, Age of Reference Person, Apparel and Services by Women, 16 and over. Retrieved from https://www.bls.gov/cex/tables/calendar-year/mean-item-share-average-standard-error/reference-person-age-ranges-2020.pdf], and necessary costs^[Garner, T. (2010). Supplemental Poverty Measure Thresholds: Laying the Foundation. Washington DC: Bureau of Labor Statistics.]—and describing how many families in each locality are struggling.

We show, too, how families are faring by race, as above, and by place. Places, or the neighborhoods within localities, are captured with census tracts, areas used by the United States Census Bureau to approximate neighborhoods. Census tracts are roughly equal in population and are bounded by major roads, rivers and railroad tracks. The geographic variation in our region is evident across these census tracts. Charlottesville for example, is a city of roughly 10 square miles that are more densely populated. Albemarle surrounds Charlottesville and dwarfs it physically at 726 square miles, but it has both dense neighborhoods and sprawling rural ones. While there is variation across the communities that define the greater Charlottesville region, there is one constant: throughout the region there are hundreds of families who struggle every day to put a roof over their heads, food in their bellies, clothes on their backs and heat in their homes.

## Localities {.tabset .tabset-pills}

### Albemarle County
```{r}
albemarle <- countydat %>% filter(countyName == "Albemarle")
```

#### Albemarle County

There are `r comma(albemarle$AllFamE)` families living in `r albemarle$countyName` County. Of these, `r comma(albemarle$AllFamUnder35kE)` (`r percent(albemarle$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working.

Albemarle County at a glance:

* Albemarle and Charlottesville are the most expensive localities in the region given the costs of housing and childcare.

* Albemarle, relative to the other localities, has the highest number of families making $25,000-34,999 a year, just below the minimum target threshold. 

* Albemarle has one of the largest racial disparities among struggling families; the percent of Black families making under $35,000 (29%) is 21% higher than the percent of white families making under $35,000 (8%). 

* Families making less than $35,000 tend to be more highly concentrated near the University of Virginia and the Oak Hill neighborhood. 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exAC <- expenses %>%
  filter(Locality == "Albemarle",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exAC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 30000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 49390, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 49390, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Albemarle County
```{r}
income_break_ac <- albemarle %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_ac[5,2])

income_break_ac <- income_break_ac %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_ac) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1))%>%
  color(j = "Cumulative", i = ~ Cumulative > 70, color = "white") 

```
<br/>
As this table shows, `r paste0(income_break_ac$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Albemarle, Black families are over-represented at the low end of the pay ranges (under $35,000 a year) and under-represented at the high end of the pay ranges (over $100,000 a year). In other words, relative to white families, Black families are more likely to be paid insufficient wages and less likely to be high-earning. 

Relative to the other localities, a higher share of Albemarle County families fall into the high-earning pay ranges—this distribution is likely related to the high cost of housing within the county. 

##### Income Distribution of Black and White Families in Albemarle County
```{r fig.align = 'center'}
alb_race_long <- albemarle %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(alb_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Albemarle Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income^[The median family income is the value for which half of families in the area make less and half of the families in the area make more.] (the first map) or the percent of families within the tract who make less than $35,000 a year (the second map). The maps show how residents are often concentrated into neighborhoods with either high-earning or low-earning families, with implications for the resources and opportunities available to the families living within each tract. 

To see which neighborhoods in Albemarle County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names. 

##### Median Family Income in Albemarle County
```{r}
ACmap <- geofull %>%
  filter(countyName == "Albemarle")

# pal <- colorBin(palette = c("#D72000", "#FFAD0A", "#1BB6AF", "#EE6100", "#9093A2", "#132157"), domain = ACmap$medianFamIncomeE)

# show_col(lacroix_palette("Apricot", type = "continuous", n = 20))
# pal_vector <- lacroix_palette("Apricot", type = "continuous", n = 20)[5:14]
pal_vector <- c("#EE6400","#F37903","#F78C05","#FCA108","#E7AD1B","#ABB046","#6FB272","#33B59D","#2DB0AC","#4CA7A9")

pal <- colorBin(pal_vector, 
                domain = geofull$medianFamIncomeE)

# pal <- colorQuantile(pal_vector,
#                      domain = ACmap$medianFamIncomeE, n = 5)

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = ACmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(ACmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", ACmap$NAME.x, "<br>",
                             "Area Name: ", ACmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = ACmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(ACmap$tractnames[which.min(ACmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(ACmap$medianFamIncomeE[which.min(ACmap$medianFamIncomeE)]))`. While undergraduate students are largely excluded from this analysis, as they aren’t residing in family households, it may include graduate students who are older, more likely to have families, and more likely to live near the university alongside other low-paid families. By contrast, the `r paste0(ACmap$tractnames[which.max(ACmap$medianFamIncomeE)])` tract has the highest median family income  at $`r paste0(comma(ACmap$medianFamIncomeE[which.max(ACmap$medianFamIncomeE)]))`. 

The following map shows the concentration of low-paid families. In Albemarle County, again, the highest percentage of low-paid families are concentrated in the Carr’s Hill-McCormick Road (UVA), Oak Hill, and Southwood tracts. Most of the other tracts in the county have no more than 20% of families making less than $35,000 a year. 

##### Percent of Families Making under $35,000 in Albemarle County
```{r}
# pal <- colorBin(palette = c("#D72000", "#FFAD0A", "#1BB6AF", "#EE6100", "#9093A2", "#132157"), domain = ACmap$perc_AllFamUnder35kE)

# show_col(lacroix_palette("Apricot", type = "continuous", n = 10))
# pal2_vector <- lacroix_palette("Apricot", type = "continuous", n = 10)[2:7]
pal2_vector <- c("#E34400","#EF6901","#F99306","#CCAF2E","#4DB48A","#41AAAA")

pal2 <- colorBin(pal2_vector, 
                domain = geofull$perc_AllFamUnder35kE,
                reverse = TRUE)

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = ACmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(ACmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", ACmap$NAME.x, "<br>",
                             "Area Name: ", ACmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = ACmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Buckingham County
```{r}
buckingham <- countydat %>% filter(countyName == "Buckingham")
```

#### Buckingham County

There are `r comma(buckingham$AllFamE)` families living in `r buckingham$countyName` County. This is the fewest number of families in a locality in the region. Of these, `r comma(buckingham$AllFamUnder35kE)` (`r percent(buckingham$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. This is the highest percent of families struggling in localities across the region.

Buckingham County at a glance:

* Buckingham is the least expensive locality in the region for families given the cost of housing and childcare, but it has the largest percentage of families earning less than they need to afford basic needs.

* In Buckingham, the percent of Black families making under $35,000 a year (39%) is 17% higher than the percent of white families making under $35,000 (22%). 

* Buckingham, relative to the other localities, has the lowest percent of families making over $100k/year—a higher share of Buckingham’s families are concentrated in the lower pay ranges. 

* The concentration of low-paid families is less obvious in Buckingham relative to the other localities. Because so many families are paid under $35,000 a year in Buckingham, the share of low-paid families is over 20% across all tracts. 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exBC <- expenses %>%
  filter(Locality == "Buckingham",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exBC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 20000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 40000, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 40000, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Buckingham County
```{r}
income_break_bc <- buckingham %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_bc[5,2])

income_break_bc <- income_break_bc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_bc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(j = "Cumulative", i = ~Cumulative > 70, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_bc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Buckingham, Black families are over-represented at the low end of the pay ranges (under $35,000) and deeply under-represented at the high end of the pay ranges (over $100,000). In other words, relative to white families, Black families are more likely to be paid insufficient wages and less likely to be high-earning. 

Relative to the other localities, in Buckingham County, a higher share of families overall fall into the low-earning pay ranges. 

##### Income Distribution of Black and White Families in Buckingham County
```{r fig.align = 'center'}
buc_race_long <- buckingham %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(buc_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Buckingham Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income (the first map) or the percent of families within the tract who make less than $35,000 a year (the second map). In Buckingham County, the median family income is low, relative to the other counties, across all tracts. 

To see which neighborhoods in Buckingham County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names. 

##### Median Family Income in Buckingham County
```{r}
BCmap <- geofull %>%
  filter(countyName == "Buckingham")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = BCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(BCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", BCmap$NAME.x, "<br>",
                             "Area Name: ", BCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = BCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(BCmap$tractnames[which.min(BCmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(BCmap$medianFamIncomeE[which.min(BCmap$medianFamIncomeE)]))`. However, relative to the other localities, the difference between the lowest median family income and the highest median family income in Buckingham is small—the `r paste0(BCmap$tractnames[which.max(BCmap$medianFamIncomeE)])` tract has the highest median family income ($`r paste0(comma(BCmap$medianFamIncomeE[which.max(BCmap$medianFamIncomeE)]))`). 

The following map shows the concentration of low-paid families. In Buckingham County, the tract with the lowest median family income also has the highest percentage of families making under $35,000. 

##### Percent of Families Making under $35,000 in Buckingham County
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = BCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(BCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", BCmap$NAME.x, "<br>",
                             "Area Name: ", BCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = BCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Charlottesville City
```{r}
charlottesville <- countydat %>% filter(countyName == "Charlottesville")
```

#### Charlottesville City

There are `r comma(charlottesville$AllFamE)` families living in the city of `r charlottesville$countyName`. Of these, `r comma(charlottesville$AllFamUnder35kE)` (`r percent(charlottesville$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. 

Charlottesville City at a glance:

* Charlottesville and Albemarle County are the most expensive localities in the region given the costs of housing and childcare.

* Charlottesville has the largest racial disparity among struggling families; the percent of Black families making under $35,000 (48%) is 36% higher than the percent of white families making under $35,000 (12%). 

* Families making less than $35,000 a year tend to be more highly concentrated near the University of Virginia, in the 10th & Page and Venable neighborhoods and the JPA and Fontaine neighborhoods. 


##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exCC <- expenses %>%
  filter(Locality == "Charlottesville",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exCC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 30000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 49390, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 49390, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Charlottesville City
```{r}
income_break_cc <- charlottesville %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_cc[5,2])

income_break_cc <- income_break_cc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_cc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 50, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1))%>%
  color(j = "Cumulative", i = ~Cumulative > 50, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_cc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families. In Charlottesville, however, the percent of families making under $35,000 a year are more evenly distributed across the $0-$14,999 and $15,000-$34,999 ranges. This distribution means that more families, relative to the other localities, are in the lowest income range.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Charlottesville, Black families are highly over-represented at the low end of the pay ranges (under $35,000 a year) and under-represented at the high end of the pay ranges (over $100,000 a year). In other words, relative to white families, Black families are more likely to be paid insufficient wages and less likely to be high-earning. 

##### Income Distribution of Black and White Families in Charlottesville City
```{r fig.align = 'center'}
cvl_race_long <- charlottesville %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(cvl_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Charlottesville Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income or the percent of families within the tract who make less than $35,000. The maps show how residents are often concentrated into neighborhoods with either high-earning or low-earning families, with implications for the resources and opportunities available to the families living within each tract. 

To see which neighborhoods in the city of Charlottesville have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names. 

##### Median Family Income in Charlottesville City
```{r}
CCmap <- geofull %>%
  filter(countyName == "Charlottesville")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = CCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(CCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", CCmap$NAME.x, "<br>",
                             "Area Name: ", CCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = CCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(CCmap$tractnames[which.min(CCmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(CCmap$medianFamIncomeE[which.min(CCmap$medianFamIncomeE)]))`. By contrast, the `r paste0(CCmap$tractnames[which.max(CCmap$medianFamIncomeE)])` tract has the highest median family income at $`r paste0(comma(CCmap$medianFamIncomeE[which.max(CCmap$medianFamIncomeE)]))`, making the disparity between the lowest and highest median family incomes well-over $100k. 

The following map shows the concentration of low-paid families. For Charlottesville, it shows a similar pattern as the previous map—the highest percentage of low-paid families are concentrated in the 10th & Page-Venable and JPA-Fontaine tracts. The Barracks-Rugby tract, in addition to having the highest median family income, also has the lowest percent of families making less than $35,000.

##### Percent of Families Making under $35,000 in Charlottesville City
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = CCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(CCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", CCmap$NAME.x, "<br>",
                             "Area Name: ", CCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = CCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Fluvanna County
```{r}
fluvanna <- countydat %>% filter(countyName == "Fluvanna")
```

#### Fluvanna County

There are `r comma(fluvanna$AllFamE)` families living in `r fluvanna$countyName` County. Of these, `r comma(fluvanna$AllFamUnder35kE)` (`r percent(fluvanna$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. 

Fluvanna County at a glance:

* Fluvanna ranks as the third most expensive locality for families in the region given the costs of housing and childcare.

* Fluvanna has the lowest percent of struggling families across the region, and the smallest racial disparity across struggling families. The percent of Black families making under $35,000 (11%) is 4% higher than the percent of white families making under $35,000 (7%). 

* Fluvanna, relative to the other localities, has the largest percent of families making in the  $60,000-$100,000 a year range, and the second largest percent of families making over $100,000. 

* Relative to the other counties, the spatial difference between the highest median family income in a tract and the lowest is smaller in Fluvanna. In other words, the median family income is more consistent across the areas in Fluvanna than it is in other counties. 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exFC <- expenses %>%
  filter(Locality == "Fluvanna",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exFC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 30000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 40000, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 40000, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Fluvanna County
```{r}
income_break_fc <- fluvanna %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_fc[5,2])

income_break_fc <- income_break_fc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_fc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(j = "Cumulative", i = ~Cumulative > 70, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_fc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Fluvanna, while Black families are over-represented at the low end of the pay range (under $35,000) and under-represented at the high end of the pay range (over $100,000), the disparity here is much smaller than across the region as a whole. 

##### Income Distribution of Black and White Families in Fluvanna County
```{r fig.align = 'center'}
flv_race_long <- fluvanna %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(flv_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Fluvanna Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income or the percent of families within the tract who make less than $35,000. Having a higher percentage of struggling families in an area has implications for the resources and opportunities available to the families living there.

To see which neighborhoods in Fluvanna County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names.


##### Median Family Income in Fluvanna County
```{r}
FCmap <- geofull %>%
  filter(countyName == "Fluvanna")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = FCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(FCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", FCmap$NAME.x, "<br>",
                             "Area Name: ", FCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = FCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(FCmap$tractnames[which.min(FCmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(FCmap$medianFamIncomeE[which.min(FCmap$medianFamIncomeE)]))`. By contrast, the `r paste0(FCmap$tractnames[which.max(FCmap$medianFamIncomeE)])` tract has the highest median family income at $`r paste0(comma(FCmap$medianFamIncomeE[which.max(FCmap$medianFamIncomeE)]))`. Relative to the other localities, the difference between the lowest and highest values is small. On the other hand, the highest median family income in Fluvanna is much lower than the highest median family income in Albemarle or Charlottesville. 

The following map shows the concentration of low-paid families. As in other counties, the tract with the lowest median family income in Fluvanna also has the highest percentage of families making less than $35,000 per year. 

##### Percent of Families Making under $35,000 in Fluvanna County
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = FCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(FCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", FCmap$NAME.x, "<br>",
                             "Area Name: ", FCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = FCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Greene County
```{r}
greene <- countydat %>% filter(countyName == "Greene")
```

#### Greene County

There are `r comma(greene$AllFamE)` families living in `r greene$countyName` County. Of these, `r comma(greene$AllFamUnder35kE)` (`r percent(greene$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. 

Greene County at a glance:

* The costs of basic needs and working for Greene residents are around $52,000, lower than the cost of expenses in Albemarle, Charlottesville, and Fluvanna but higher than the associated expenses in Nelson, Louisa, and Buckingham.

* In Greene, the percent of Black families making under $35,000 a year (20%) is `r paste0(round(greene$perc_BlackFamUnder35kE - greene$perc_WhiteFamUnder35kE, 0), "%")` higher than the percent of white families making under $35,000 a year (12%). 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exGC <- expenses %>%
  filter(Locality == "Greene",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exGC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 30000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 40000, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 40000, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Greene County
```{r}
income_break_gc <- greene %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_gc[5,2])

income_break_gc <- income_break_gc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_gc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(j = "Cumulative", i = ~Cumulative > 70, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_gc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Greene County, Black families are very over-represented at the low end of the pay range (under $35,000) and slightly under-represented at the high end of the pay range (over $100,000). In other words, relative to white families, Black families are more likely to be paid insufficient wages. 

##### Income Distribution of Black and White Families in Greene County
```{r fig.align = 'center'}
grn_race_long <- greene %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(grn_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Greene Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income or the percent of families within the tract who make less than $35,000 yearly. 

To see which neighborhoods in Greene County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names.

##### Median Family Income in Greene County
```{r}
GCmap <- geofull %>%
  filter(countyName == "Greene")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = GCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(GCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", GCmap$NAME.x, "<br>",
                             "Area Name: ", GCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = GCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(GCmap$tractnames[which.min(GCmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(GCmap$medianFamIncomeE[which.min(GCmap$medianFamIncomeE)]))`. By contrast, the `r paste0(GCmap$tractnames[which.max(GCmap$medianFamIncomeE)])` tract has the highest median family income at $`r paste0(comma(GCmap$medianFamIncomeE[which.max(GCmap$medianFamIncomeE)]))`. 

The following map shows the concentration of low-paid families. Similar to the other counties, in Greene County, the tract with the lowest median family income also has the highest percentage of families making less than $35,000. 

##### Percent of Families Making under $35,000 in Greene County
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = GCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(GCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", GCmap$NAME.x, "<br>",
                             "Area Name: ", GCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = GCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Louisa County
```{r}
louisa <- countydat %>% filter(countyName == "Louisa")
```

#### Louisa County

There are `r comma(louisa$AllFamE)` families living in `r louisa$countyName` County. Of these, `r comma(louisa$AllFamUnder35kE)` (`r percent(louisa$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. 

Louisa at a glance:

* Louisa has the second highest number of families falling behind: 19% of the 9,413 families struggling in our region live in Louisa. 

* Louisa has one of the lowest costs for basic needs and the cost of working, at $45,917, second only to Buckingham.

* In Louisa, the percent of Black families making under $35,000 (26%) is 11% higher than the percent of white families making under $35,000 (15%). 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exLC <- expenses %>%
  filter(Locality == "Louisa",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exLC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 27000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 40000, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 40000, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Louisa County
```{r}
income_break_lc <- louisa %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_lc[5,2])

income_break_lc <- income_break_lc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_lc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(j = "Cumulative", i = ~Cumulative > 70, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_lc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Louisa, Black families are over-represented at the low end of the pay range (under $35,000) and under-represented at the high end of the pay range (over $100k/year). In other words, relative to white families, Black families are more likely to be paid insufficient wages and less likely to be high-earning. 

##### Income Distribution of Black and White Families in Louisa County
```{r fig.align = 'center'}
lsa_race_long <- louisa %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(lsa_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Louisa Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income or the percent of families within the tract who make less than $35,000 a year. Having a higher percentage of struggling families in a neighborhood has implications for the resources and opportunities available to the families living there. 

To see which neighborhoods in Louisa County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names.

##### Median Family Income in Louisa County
```{r}
LCmap <- geofull %>%
  filter(countyName == "Louisa")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = LCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(LCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", LCmap$NAME.x, "<br>",
                             "Area Name: ", LCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = LCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The lowest median family income is around the `r paste0(LCmap$tractnames[which.min(LCmap$medianFamIncomeE)])`, at $`r paste0(comma(LCmap$medianFamIncomeE[which.min(LCmap$medianFamIncomeE)]))`. By contrast, the `r paste0(LCmap$tractnames[which.max(LCmap$medianFamIncomeE)])` tract has the highest median family income at $`r paste0(comma(LCmap$medianFamIncomeE[which.max(LCmap$medianFamIncomeE)]))`. 

The following map shows the concentration of low-paid families. Similar to the other counties, in Louisa County, the tract with the lowest median family income also has the highest percentage of families making less than $35,000 per year. 

##### Percent of Families Making under $35,000 in Louisa County
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = LCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(LCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", LCmap$NAME.x, "<br>",
                             "Area Name: ", LCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = LCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

### Nelson County
```{r}
nelson <- countydat %>% filter(countyName == "Nelson")
```

#### Nelson County

There are `r comma(nelson$AllFamE)` families living in `r nelson$countyName` County. Of these, `r comma(nelson$AllFamUnder35kE)` (`r percent(nelson$perc_AllFamUnder35kE, scale = 1, accuracy = 0.1)`) do not earn enough to provide for their basic needs and the costs associated with working. 

Nelson County at a glance:

* Nelson ranks as the third least expensive locality for families in the region given the costs of housing and childcare.

* In Nelson, the percent of Black families making under $35,000 a year (29%) is `r paste0(round(nelson$perc_BlackFamUnder35kE - nelson$perc_WhiteFamUnder35kE, 0), "%")` higher than the percent of white families making under $35,000 a year (17%). 

##### Expenses: Single Householder + 2 Children (1 Toddler)
```{r}
exNC <- expenses %>%
  filter(Locality == "Nelson",
         Unit == "Total") %>%
  select(Expense, Annual, Monthly, Weekly)

flextable(exNC) %>% 
  width(width = 5) %>%
  align(align = "center", part = "all") %>% 
  bg(i = ~Annual > 30000, bg = lowlightcolor) %>% 
  bg(i = ~Annual > 40000, bg = highlightcolor) %>%
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(i = ~Annual > 40000, color = "white") 
```
<br/>

##### Breakdown of Families Making under $35,000 in Nelson County
```{r}
income_break_nc <- nelson %>% 
  select(AllFamUnder10kE, AllFamBtw10_14kE,
         AllFamBtw15_24kE, AllFamBtw25_34kE, AllFamUnder35kE) %>% 
  pivot_longer(cols = everything(), names_to = "Income", values_to = "Number") %>% 
  group_by(Income) %>% 
  summarize(Number = sum(Number)) %>% 
  mutate(Income = factor(Income, 
                         levels = c("AllFamUnder10kE", "AllFamBtw10_14kE",
                                    "AllFamBtw15_24kE", "AllFamBtw25_34kE",
                                    "AllFamUnder35kE"),
                         labels = c("$0 - $9,999", "$10,000 - $14,999",
                                    "$15,000 - $24,999", "$25,000 - $34,999",
                                    "Total"))) %>% 
  arrange(Income) %>% mutate(group = c(1,1,2,2,3))

totfam <- as_vector(income_break_nc[5,2])

income_break_nc <- income_break_nc %>% 
  mutate(Percent = round((Number/totfam)*100, 0)) %>% 
  group_by(group) %>% 
  mutate(Cumulative = sum(Percent)) %>% 
  ungroup() %>% 
  select(-group)

flextable(income_break_nc) %>% 
  merge_v() %>% 
  merge_h() %>% 
  width(width = 5) %>% 
  align(align = "center", part = "all") %>% 
  bg(j = "Cumulative", bg = lowlightcolor) %>%
  bg(j = "Cumulative", i = ~ Cumulative > 70, bg = highlightcolor) %>% 
  colformat_num(j = c("Percent", "Cumulative"), suffix = "%") %>% 
  border_inner_h(border = fp_border(color="gray", width=1)) %>%
  color(j = "Cumulative", i = ~Cumulative > 70, color = "white") 
```
<br/>
As this table shows, `r paste0(income_break_nc$Cumulative[4], "%")` of the families who cannot meet their basic needs earn between $15,000-$35,000 annually. This strongly suggests they are working, but not earning the wages or not getting the hours they need to support their families.

The figure below shows the distribution of families in various pay ranges, disaggregated by race. In a world with racial equity in income, the bars for all families would be equal in height. In Nelson County, Black families are over-represented at the low end of the pay range (under $35,000) and under-represented at the high end of the pay range (over $100k/year). In other words, relative to white families, Black families are more likely to be paid insufficient wages and less likely to be high-earning. 

##### Income Distribution of Black and White Families in Nelson County
```{r fig.align = 'center'}
nel_race_long <- nelson %>% 
  select(perc_AllFamUnder35kE, perc_WhiteFamUnder35kE, perc_BlackFamUnder35kE,
         perc_AllFamBtw35_59kE, perc_WhiteFamBtw35_59kE, perc_BlackFamBtw35_59kE,
         perc_AllFamBtw60_100kE, perc_WhiteFamBtw60_100kE, perc_BlackFamBtw60_100kE,
         perc_AllFamOver100kE, perc_WhiteFamOver100kE, perc_BlackFamOver100kE) %>% 
  pivot_longer(cols = everything(), names_to = c("fam", "inc"), 
               names_pattern = "perc_(AllFam|BlackFam|WhiteFam)(.+)", 
               values_to = "Percent") %>% 
  mutate(inc = factor(inc, levels = c("Under35kE", "Btw35_59kE", "Btw60_100kE", "Over100kE"),
                      labels = c("Earning Under $35K", "Earning $35K-$59,999K", "Earning $60-100k","Earning Over $100K")),
         fam = factor(fam, levels = c("AllFam", "BlackFam", "WhiteFam"),
                      labels = c("All families", "Black families", "White families")))

ggplot(nel_race_long, aes(y = Percent,
                           x = inc, 
                           fill = fam)) + 
  geom_col(position="dodge") +
  labs(title = "Percent of Nelson Families", x = "", y = "") + 
  geom_text(aes(label = percent(Percent, scale = 1, accuracy = 1)),
            position = position_dodge(width=0.9), vjust = -0.25, 
            size = 4) + 
  scale_fill_manual(values=c("#FFAD0A", "#1BB6AF", "#7473A6"), 
                    name = element_blank()) + 
  scale_y_continuous(labels = label_percent(scale = 1)) +
  # annotate("text", x = 1.1, y = 30.5, size = 3, color = "gray50",
  #          label = "Percent in region (14%)", hjust = "left") +
  theme_minimal() +
  #coord_flip() +
  #guides(fill = guide_legend(reverse = TRUE)) +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        plot.title = element_text(size=16, hjust = 0.5))
```
<br/>
The maps below show the spatial relationship between income and neighborhood. The color of each census tract in the county is based on the median family income or the percent of families within the tract who make less than $35,000 per year. Having a higher percentage of struggling families in an area has implications for the resources and opportunities available to the families living there. 

To see which neighborhoods in Nelson County have the highest and lowest median family incomes, click on each tract to see its median income and neighborhood names.

##### Median Family Income in Nelson County
```{r}
NCmap <- geofull %>%
  filter(countyName == "Nelson")

leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = NCmap,
              fillColor = ~pal(medianFamIncomeE),
              # fillColor = ~lacroix_palette("Apricot", type = "continuous"),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T),
              popup = paste0("Median family income: ", "$", comma(NCmap$medianFamIncomeE), "<br>",
                             "Census Tract: ", NCmap$NAME.x, "<br>",
                             "Area Name: ", NCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal, values = NCmap$medianFamIncomeE, 
            title = "Median family income", opacity = 0.7)
```

The `r paste0(NCmap$tractnames[which.min(NCmap$medianFamIncomeE)])` tract has the lowest median family incomes at $`r paste0(comma(NCmap$medianFamIncomeE[which.min(NCmap$medianFamIncomeE)]))`. By contrast, the `r paste0(NCmap$tractnames[which.max(NCmap$medianFamIncomeE)])` tract has the highest median family income at $`r paste0(comma(NCmap$medianFamIncomeE[which.max(NCmap$medianFamIncomeE)]))`. 

The following map shows the concentration of low-paid families. Similar to the other counties, in Fluvanna County, the tract with the lowest median family income also has the highest percentage of families making less than $35,000 yearly. 

##### Percent of Families Making under $35,000 in Nelson County
```{r}
leaflet() %>% 
  leaflet(width = "100%") %>%
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = NCmap,
              fillColor = ~pal2(perc_AllFamUnder35kE),
              weight = 1,
              opacity = 1,
              color = "white", 
              fillOpacity = 0.6,
              smoothFactor = 0.3,
              highlight = highlightOptions(
                weight = 1, fillOpacity = 0.8, bringToFront = T
              ),
              popup = paste0("Percent of families: ", round(NCmap$perc_AllFamUnder35kE,1), "%", "<br>",
                             "Census Tract: ", NCmap$NAME.x, "<br>",
                             "Area Name: ", NCmap$tractname)) %>% 
  addLegend("bottomright", pal = pal2, values = NCmap$perc_AllFamUnder35kE, 
            title = "Percent of families <br> making < $35,000", opacity = 0.7)
```
[Return to Localities ↩︎](#localities)

# Conclusion

> "When someone works for less pay than she can live on—when, for example, she goes hungry so that you can eat more cheaply and conveniently—then she has made a great sacrifice for you, she has made you a gift of some part of her abilities, her health, and her life. The 'working poor,' as they are approvingly termed, are in fact the major philanthropists of our society." 
>
> --- Barbara Ehrenreich.^[Barbara Ehrenreich (2001). Nickel and Dimed: On (Not) Getting By in America. Metropolitan Books.]

Based on data collected from 2016-2020, at least 9,413 families in the larger Charlottesville region make less than $35,000 a year, far below what’s necessary to afford the essentials of life—food, shelter, clothing and utilities—and additional costs incurred by working. These families reside throughout our region. While Albemarle County, Louisa County, and the City of Charlottesville have the highest number of struggling families, Buckingham County, the City of Charlottesville, and Nelson County have the highest percent of struggling families. And across each locality in our region, the percent of Black families making less than $35,000 exceeds the percent of white families making less than $35,000. Despite working equally hard, the labor of Black families in the Charlottesville region is not equally valued.

We are making steady progress in decreasing the number, and percent, of families making under $35,000 annually. The cost of living, however, continues to rise—currently working families with a toddler and a preschooler need between $42,000 and $50,000 to be self-sufficient, based largely on the cost of housing and childcare. And inflationary forces can rapidly shift the fortunes of struggling families.

We consider this estimate of nearly 10,000 struggling families a minimum, and while lower than that found in prior Orange Dot Reports, it is too many. No one should labor full time for insufficient wages, and our treatment of our essential workers must improve; their labor should not be a sacrifice for our comfort. The pandemic showed us how essential is the labor of workers who keep our shelves stocked and our stores open, who help care for our children and our parents, who ensure our transportation and logistics systems for people and goods keep running. Our dependence on one another to keep society functioning has rarely been so clear. That same interdependence demands we do more to help struggling families reach positions of greater financial security.

The second part of this report, to be released in the spring, will review community efforts to provide families with the better paying jobs they need to succeed, including a review of the approach and progress of the pioneering Network2Work framework, as well as opportunities to create more pipelines into stable regional employers. The spring release will further consider approaches to addressing the rising costs that threaten to increase the number of families who struggle in our region—housing and access to capital, child care and early education. Promoting the well-being and thriving of all of our neighbors, and, in turn, of our community, will require sustained, cooperative, and intentional effort by individuals, government and non-governmental organizations, powerful employers, and more. In short, by our local, state, and national economic actors and by our public and civic society. 


# Notes
